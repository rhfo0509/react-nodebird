{"version":3,"file":"../pages/index.js","mappings":"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","sources":["webpack://ch0/./components/PostForm.js","webpack://ch0/./pages/index.js","webpack://ch0/external commonjs \"@ant-design/icons\"","webpack://ch0/external commonjs \"antd\"","webpack://ch0/external commonjs \"moment\"","webpack://ch0/external commonjs \"next-redux-wrapper\"","webpack://ch0/external commonjs \"next/dist/shared/lib/app-router-context.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/head-manager-context.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/i18n/normalize-locale-path.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/is-plain-object.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/mitt.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/page-path/denormalize-page-path.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router-context.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router/utils/add-path-prefix.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router/utils/compare-states.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router/utils/format-next-pathname-info.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router/utils/format-url.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router/utils/get-asset-path-from-route.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router/utils/get-next-pathname-info.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router/utils/is-bot.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router/utils/is-dynamic.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router/utils/parse-path.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router/utils/parse-relative-url.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router/utils/path-has-prefix.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router/utils/querystring.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router/utils/remove-trailing-slash.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router/utils/resolve-rewrites.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router/utils/route-matcher.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router/utils/route-regex.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/utils.js\"","webpack://ch0/external commonjs \"next/router\"","webpack://ch0/external commonjs \"react\"","webpack://ch0/external commonjs \"react-redux\"","webpack://ch0/external commonjs \"react-slick\"","webpack://ch0/external commonjs \"react/jsx-runtime\"","webpack://ch0/external commonjs \"redux\"","webpack://ch0/external commonjs \"redux-devtools-extension\"","webpack://ch0/external commonjs \"redux-saga/effects\"","webpack://ch0/external commonjs \"styled-components\"","webpack://ch0/external module \"axios\"","webpack://ch0/external module \"immer\"","webpack://ch0/external module \"redux-saga\""],"sourcesContent":["import React, { useCallback, useEffect, useRef } from \"react\";\nimport { Button, Form, Input } from \"antd\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport {\n  UPLOAD_IMAGES_REQUEST,\n  REMOVE_IMAGE,\n  ADD_POST_REQUEST,\n} from \"../reducers/post\";\nimport useInput from \"../hooks/useInput\";\n\nconst PostForm = () => {\n  const { imagePaths, addPostDone } = useSelector((state) => state.post);\n  const dispatch = useDispatch();\n\n  const [text, onChangeText, setText] = useInput(\"\");\n\n  useEffect(() => {\n    if (addPostDone) {\n      setText(\"\");\n    }\n  }, [addPostDone]);\n\n  const onSubmit = useCallback(() => {\n    if (!text || !text.trim()) {\n      return alert(\"게시글을 작성하세요.\");\n    }\n    const formData = new FormData();\n    imagePaths.forEach((p) => {\n      formData.append(\"image\", p);\n    });\n    formData.append(\"content\", text);\n    dispatch({\n      type: ADD_POST_REQUEST,\n      data: formData,\n    });\n  }, [text, imagePaths]);\n\n  const imageInput = useRef();\n  const onClickImageUpload = useCallback(() => {\n    imageInput.current.click();\n  }, [imageInput.current]);\n\n  const onChangeImages = useCallback((e) => {\n    console.log(\"images\", e.target.files);\n    const formData = new FormData();\n    [...e.target.files].forEach((f) => {\n      formData.append(\"image\", f);\n    });\n    dispatch({ type: UPLOAD_IMAGES_REQUEST, data: formData });\n  }, []);\n\n  const onRemoveImage = useCallback(\n    (index) => () => {\n      dispatch({ type: REMOVE_IMAGE, data: index });\n    },\n    []\n  );\n\n  return (\n    <Form\n      style={{ margin: \"10px 0 20px\" }}\n      encType=\"multipart/form-data\"\n      onFinish={onSubmit}\n    >\n      <Input.TextArea\n        value={text}\n        onChange={onChangeText}\n        maxLength={140}\n        placeholder=\"어떤 신기한 일이 있었나요?\"\n      />\n      <div>\n        <input\n          type=\"file\"\n          name=\"image\"\n          multiple\n          hidden\n          ref={imageInput}\n          onChange={onChangeImages}\n        />\n        <Button onClick={onClickImageUpload}>이미지 업로드</Button>\n        <Button type=\"primary\" style={{ float: \"right\" }} htmlType=\"submit\">\n          짹짹\n        </Button>\n      </div>\n      <div>\n        {imagePaths.map((v, i) => (\n          <div key={v} style={{ display: \"inline-block\" }}>\n            <img\n              src={v.replace(/\\/thumb\\//, \"/original/\")}\n              style={{ width: \"200px\" }}\n              alt={v}\n            />\n            <div>\n              <Button onClick={onRemoveImage(i)}>제거</Button>\n            </div>\n          </div>\n        ))}\n      </div>\n    </Form>\n  );\n};\n\nexport default PostForm;\n","import React, { useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { END } from \"redux-saga\";\nimport axios from \"axios\";\nimport wrapper from \"../store/configureStore\";\n\nimport AppLayout from \"../components/AppLayout\";\nimport PostForm from \"../components/PostForm\";\nimport PostCard from \"../components/PostCard\";\nimport { LOAD_POSTS_REQUEST } from \"../reducers/post\";\nimport { LOAD_MY_INFO_REQUEST } from \"../reducers/user\";\n\nconst Home = () => {\n  const dispatch = useDispatch();\n  const { mainPosts, hasMorePosts, loadPostsLoading, retweetError } =\n    useSelector((state) => state.post);\n  const { me } = useSelector((state) => state.user);\n\n  useEffect(() => {\n    if (retweetError) {\n      alert(retweetError);\n    }\n  }, [retweetError]);\n\n  useEffect(() => {\n    const onScroll = () => {\n      if (\n        window.scrollY + document.documentElement.clientHeight >\n        document.documentElement.scrollHeight - 300\n      ) {\n        if (hasMorePosts && !loadPostsLoading) {\n          const lastId = mainPosts[mainPosts.length - 1]?.id;\n          dispatch({\n            type: LOAD_POSTS_REQUEST,\n            lastId,\n          });\n        }\n      }\n    };\n    window.addEventListener(\"scroll\", onScroll);\n    return () => {\n      window.removeEventListener(\"scroll\", onScroll);\n    };\n  }, [mainPosts.length, hasMorePosts, loadPostsLoading]);\n  return (\n    <AppLayout>\n      {me && <PostForm />}\n      {mainPosts.map((post) => (\n        <PostCard key={post.id} post={post} />\n      ))}\n    </AppLayout>\n  );\n};\n\nexport const getServerSideProps = wrapper.getServerSideProps(\n  (store) =>\n    async ({ req }) => {\n      const cookie = req ? req.headers.cookie : \"\";\n      axios.defaults.headers.Cookie = \"\";\n      if (req && cookie) {\n        axios.defaults.headers.Cookie = cookie;\n      }\n      store.dispatch({ type: LOAD_MY_INFO_REQUEST });\n      store.dispatch({ type: LOAD_POSTS_REQUEST });\n      store.dispatch(END);\n      await store.sagaTask.toPromise();\n    }\n);\nexport default Home;\n","module.exports = require(\"@ant-design/icons\");","module.exports = require(\"antd\");","module.exports = require(\"moment\");","module.exports = require(\"next-redux-wrapper\");","module.exports = require(\"next/dist/shared/lib/app-router-context.js\");","module.exports = require(\"next/dist/shared/lib/head-manager-context.js\");","module.exports = require(\"next/dist/shared/lib/i18n/normalize-locale-path.js\");","module.exports = require(\"next/dist/shared/lib/is-plain-object.js\");","module.exports = require(\"next/dist/shared/lib/mitt.js\");","module.exports = require(\"next/dist/shared/lib/page-path/denormalize-page-path.js\");","module.exports = require(\"next/dist/shared/lib/router-context.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/add-path-prefix.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/compare-states.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/format-next-pathname-info.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/format-url.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/get-asset-path-from-route.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/get-next-pathname-info.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/is-bot.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/is-dynamic.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/parse-path.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/parse-relative-url.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/path-has-prefix.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/querystring.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/remove-trailing-slash.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/resolve-rewrites.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/route-matcher.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/route-regex.js\");","module.exports = require(\"next/dist/shared/lib/utils.js\");","module.exports = require(\"next/router\");","module.exports = require(\"react\");","module.exports = require(\"react-redux\");","module.exports = require(\"react-slick\");","module.exports = require(\"react/jsx-runtime\");","module.exports = require(\"redux\");","module.exports = require(\"redux-devtools-extension\");","module.exports = require(\"redux-saga/effects\");","module.exports = require(\"styled-components\");","module.exports = import(\"axios\");;","module.exports = import(\"immer\");;","module.exports = import(\"redux-saga\");;"],"names":["React","useCallback","useEffect","useRef","Button","Form","Input","useSelector","useDispatch","UPLOAD_IMAGES_REQUEST","REMOVE_IMAGE","ADD_POST_REQUEST","useInput","PostForm","imagePaths","addPostDone","state","post","dispatch","text","onChangeText","setText","onSubmit","trim","alert","formData","FormData","forEach","p","append","type","data","imageInput","onClickImageUpload","current","click","onChangeImages","e","console","log","target","files","f","onRemoveImage","index","margin","float","map","v","i","display","replace","width","END","axios","wrapper","AppLayout","PostCard","LOAD_POSTS_REQUEST","LOAD_MY_INFO_REQUEST","Home","mainPosts","hasMorePosts","loadPostsLoading","retweetError","me","user","onScroll","window","scrollY","document","documentElement","clientHeight","scrollHeight","lastId","length","id","addEventListener","removeEventListener","getServerSideProps","store","req","cookie","headers","defaults","Cookie","sagaTask","toPromise"],"sourceRoot":""}