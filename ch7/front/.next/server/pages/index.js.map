{"version":3,"file":"../pages/index.js","mappings":"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","sources":["webpack://ch0/./components/PostForm.js","webpack://ch0/./pages/index.js","webpack://ch0/external commonjs \"@ant-design/icons\"","webpack://ch0/external commonjs \"antd\"","webpack://ch0/external commonjs \"moment\"","webpack://ch0/external commonjs \"next-redux-wrapper\"","webpack://ch0/external commonjs \"next/dist/shared/lib/app-router-context.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/head-manager-context.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/i18n/normalize-locale-path.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/is-plain-object.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/mitt.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/page-path/denormalize-page-path.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router-context.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router/utils/add-path-prefix.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router/utils/compare-states.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router/utils/format-next-pathname-info.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router/utils/format-url.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router/utils/get-asset-path-from-route.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router/utils/get-next-pathname-info.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router/utils/is-bot.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router/utils/is-dynamic.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router/utils/parse-path.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router/utils/parse-relative-url.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router/utils/path-has-prefix.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router/utils/querystring.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router/utils/remove-trailing-slash.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router/utils/resolve-rewrites.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router/utils/route-matcher.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/router/utils/route-regex.js\"","webpack://ch0/external commonjs \"next/dist/shared/lib/utils.js\"","webpack://ch0/external commonjs \"next/router\"","webpack://ch0/external commonjs \"react\"","webpack://ch0/external commonjs \"react-redux\"","webpack://ch0/external commonjs \"react-slick\"","webpack://ch0/external commonjs \"react/jsx-runtime\"","webpack://ch0/external commonjs \"redux\"","webpack://ch0/external commonjs \"redux-devtools-extension\"","webpack://ch0/external commonjs \"redux-saga/effects\"","webpack://ch0/external commonjs \"styled-components\"","webpack://ch0/external module \"axios\"","webpack://ch0/external module \"immer\"","webpack://ch0/external module \"redux-saga\""],"sourcesContent":["import React, { useCallback, useEffect, useRef } from \"react\";\r\nimport { Button, Form, Input } from \"antd\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport {\r\n  UPLOAD_IMAGES_REQUEST,\r\n  REMOVE_IMAGE,\r\n  ADD_POST_REQUEST,\r\n} from \"../reducers/post\";\r\nimport useInput from \"../hooks/useInput\";\r\n\r\nconst PostForm = () => {\r\n  const { imagePaths, addPostDone } = useSelector((state) => state.post);\r\n  const dispatch = useDispatch();\r\n\r\n  const [text, onChangeText, setText] = useInput(\"\");\r\n\r\n  useEffect(() => {\r\n    if (addPostDone) {\r\n      setText(\"\");\r\n    }\r\n  }, [addPostDone]);\r\n\r\n  const onSubmit = useCallback(() => {\r\n    if (!text || !text.trim()) {\r\n      return alert(\"게시글을 작성하세요.\");\r\n    }\r\n    const formData = new FormData();\r\n    imagePaths.forEach((p) => {\r\n      formData.append(\"image\", p);\r\n    });\r\n    formData.append(\"content\", text);\r\n    dispatch({\r\n      type: ADD_POST_REQUEST,\r\n      data: formData,\r\n    });\r\n  }, [text, imagePaths]);\r\n\r\n  const imageInput = useRef();\r\n  const onClickImageUpload = useCallback(() => {\r\n    imageInput.current.click();\r\n  }, [imageInput.current]);\r\n\r\n  const onChangeImages = useCallback((e) => {\r\n    console.log(\"images\", e.target.files);\r\n    const formData = new FormData();\r\n    [...e.target.files].forEach((f) => {\r\n      formData.append(\"image\", f);\r\n    });\r\n    dispatch({ type: UPLOAD_IMAGES_REQUEST, data: formData });\r\n  }, []);\r\n\r\n  const onRemoveImage = useCallback(\r\n    (index) => () => {\r\n      dispatch({ type: REMOVE_IMAGE, data: index });\r\n    },\r\n    []\r\n  );\r\n\r\n  return (\r\n    <Form\r\n      style={{ margin: \"10px 0 20px\" }}\r\n      encType=\"multipart/form-data\"\r\n      onFinish={onSubmit}\r\n    >\r\n      <Input.TextArea\r\n        value={text}\r\n        onChange={onChangeText}\r\n        maxLength={140}\r\n        placeholder=\"어떤 신기한 일이 있었나요?\"\r\n      />\r\n      <div>\r\n        <input\r\n          type=\"file\"\r\n          name=\"image\"\r\n          multiple\r\n          hidden\r\n          ref={imageInput}\r\n          onChange={onChangeImages}\r\n        />\r\n        <Button onClick={onClickImageUpload}>이미지 업로드</Button>\r\n        <Button type=\"primary\" style={{ float: \"right\" }} htmlType=\"submit\">\r\n          짹짹\r\n        </Button>\r\n      </div>\r\n      <div>\r\n        {imagePaths.map((v, i) => (\r\n          <div key={v} style={{ display: \"inline-block\" }}>\r\n            <img\r\n              src={v.replace(/\\/thumb\\//, \"/original/\")}\r\n              style={{ width: \"200px\" }}\r\n              alt={v}\r\n            />\r\n            <div>\r\n              <Button onClick={onRemoveImage(i)}>제거</Button>\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </Form>\r\n  );\r\n};\r\n\r\nexport default PostForm;\r\n","import React, { useEffect } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { END } from \"redux-saga\";\r\nimport axios from \"axios\";\r\nimport wrapper from \"../store/configureStore\";\r\n\r\nimport AppLayout from \"../components/AppLayout\";\r\nimport PostForm from \"../components/PostForm\";\r\nimport PostCard from \"../components/PostCard\";\r\nimport { LOAD_POSTS_REQUEST } from \"../reducers/post\";\r\nimport { LOAD_MY_INFO_REQUEST } from \"../reducers/user\";\r\n\r\nconst Home = () => {\r\n  const dispatch = useDispatch();\r\n  const { mainPosts, hasMorePosts, loadPostsLoading, retweetError } =\r\n    useSelector((state) => state.post);\r\n  const { me } = useSelector((state) => state.user);\r\n\r\n  useEffect(() => {\r\n    if (retweetError) {\r\n      alert(retweetError);\r\n    }\r\n  }, [retweetError]);\r\n\r\n  useEffect(() => {\r\n    const onScroll = () => {\r\n      if (\r\n        window.scrollY + document.documentElement.clientHeight >\r\n        document.documentElement.scrollHeight - 300\r\n      ) {\r\n        if (hasMorePosts && !loadPostsLoading) {\r\n          const lastId = mainPosts[mainPosts.length - 1]?.id;\r\n          dispatch({\r\n            type: LOAD_POSTS_REQUEST,\r\n            lastId,\r\n          });\r\n        }\r\n      }\r\n    };\r\n    window.addEventListener(\"scroll\", onScroll);\r\n    return () => {\r\n      window.removeEventListener(\"scroll\", onScroll);\r\n    };\r\n  }, [mainPosts.length, hasMorePosts, loadPostsLoading]);\r\n  return (\r\n    <AppLayout>\r\n      {me && <PostForm />}\r\n      {mainPosts.map((post) => (\r\n        <PostCard key={post.id} post={post} />\r\n      ))}\r\n    </AppLayout>\r\n  );\r\n};\r\n\r\nexport const getServerSideProps = wrapper.getServerSideProps(\r\n  (store) =>\r\n    async ({ req }) => {\r\n      const cookie = req ? req.headers.cookie : \"\";\r\n      axios.defaults.headers.Cookie = \"\";\r\n      if (req && cookie) {\r\n        axios.defaults.headers.Cookie = cookie;\r\n      }\r\n      store.dispatch({ type: LOAD_MY_INFO_REQUEST });\r\n      store.dispatch({ type: LOAD_POSTS_REQUEST });\r\n      store.dispatch(END);\r\n      await store.sagaTask.toPromise();\r\n    }\r\n);\r\nexport default Home;\r\n","module.exports = require(\"@ant-design/icons\");","module.exports = require(\"antd\");","module.exports = require(\"moment\");","module.exports = require(\"next-redux-wrapper\");","module.exports = require(\"next/dist/shared/lib/app-router-context.js\");","module.exports = require(\"next/dist/shared/lib/head-manager-context.js\");","module.exports = require(\"next/dist/shared/lib/i18n/normalize-locale-path.js\");","module.exports = require(\"next/dist/shared/lib/is-plain-object.js\");","module.exports = require(\"next/dist/shared/lib/mitt.js\");","module.exports = require(\"next/dist/shared/lib/page-path/denormalize-page-path.js\");","module.exports = require(\"next/dist/shared/lib/router-context.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/add-path-prefix.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/compare-states.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/format-next-pathname-info.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/format-url.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/get-asset-path-from-route.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/get-next-pathname-info.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/is-bot.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/is-dynamic.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/parse-path.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/parse-relative-url.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/path-has-prefix.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/querystring.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/remove-trailing-slash.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/resolve-rewrites.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/route-matcher.js\");","module.exports = require(\"next/dist/shared/lib/router/utils/route-regex.js\");","module.exports = require(\"next/dist/shared/lib/utils.js\");","module.exports = require(\"next/router\");","module.exports = require(\"react\");","module.exports = require(\"react-redux\");","module.exports = require(\"react-slick\");","module.exports = require(\"react/jsx-runtime\");","module.exports = require(\"redux\");","module.exports = require(\"redux-devtools-extension\");","module.exports = require(\"redux-saga/effects\");","module.exports = require(\"styled-components\");","module.exports = import(\"axios\");;","module.exports = import(\"immer\");;","module.exports = import(\"redux-saga\");;"],"names":["React","useCallback","useEffect","useRef","Button","Form","Input","useSelector","useDispatch","UPLOAD_IMAGES_REQUEST","REMOVE_IMAGE","ADD_POST_REQUEST","useInput","PostForm","imagePaths","addPostDone","state","post","dispatch","text","onChangeText","setText","onSubmit","trim","alert","formData","FormData","forEach","p","append","type","data","imageInput","onClickImageUpload","current","click","onChangeImages","e","console","log","target","files","f","onRemoveImage","index","margin","float","map","v","i","display","replace","width","END","axios","wrapper","AppLayout","PostCard","LOAD_POSTS_REQUEST","LOAD_MY_INFO_REQUEST","Home","mainPosts","hasMorePosts","loadPostsLoading","retweetError","me","user","onScroll","window","scrollY","document","documentElement","clientHeight","scrollHeight","lastId","length","id","addEventListener","removeEventListener","getServerSideProps","store","req","cookie","headers","defaults","Cookie","sagaTask","toPromise"],"sourceRoot":""}